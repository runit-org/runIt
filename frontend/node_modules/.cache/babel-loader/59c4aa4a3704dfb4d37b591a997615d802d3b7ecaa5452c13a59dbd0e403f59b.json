{"ast":null,"code":"import axios from \"axios\";\nimport store from \"../store\";\nimport jwt_decode from \"jwt-decode\";\nimport { GET_ERRORS, SET_CURRENT_USER } from \"../actions/types\";\nimport Cookies from \"js-cookie\";\nconst setToken = token => {\n  if (token) {\n    axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\n  } else {\n    delete axios.defaults.headers.common[\"Authorization\"];\n  }\n};\nconst refreshToken = () => {\n  if (Cookies.get(\"token\")) {\n    const ref = axios.post(\"http://localhost:8000/api/auth/token/refresh/\", {\n      refresh: Cookies.get(\"token\")\n    });\n    return ref;\n  } else {\n    store.dispatch({\n      type: SET_CURRENT_USER,\n      payload: null\n    });\n  }\n};\nconst getAccessToken = async () => {\n  await refreshToken().then(res => {\n    console.log(res);\n    setToken(res.data.access);\n    const decoded_token = jwt_decode(res.data.access);\n    store.dispatch({\n      type: SET_CURRENT_USER,\n      payload: decoded_token\n    });\n  }).catch(error => {\n    store.dispatch({\n      type: GET_ERRORS,\n      payload: error.message\n    });\n    store.dispatch({\n      type: SET_CURRENT_USER,\n      payload: null\n    });\n  });\n};\nexport { setToken, refreshToken, getAccessToken };","map":{"version":3,"names":["axios","store","jwt_decode","GET_ERRORS","SET_CURRENT_USER","Cookies","setToken","token","defaults","headers","common","refreshToken","get","ref","post","refresh","dispatch","type","payload","getAccessToken","then","res","console","log","data","access","decoded_token","catch","error","message"],"sources":["/Users/Manan/Desktop/runIt/frontend/src/securityUtils/setToken.js"],"sourcesContent":["import axios from \"axios\";\nimport store from \"../store\";\nimport jwt_decode from \"jwt-decode\";\nimport { GET_ERRORS, SET_CURRENT_USER } from \"../actions/types\";\nimport Cookies from \"js-cookie\";\n\nconst setToken = (token) => {\n  if (token) {\n    axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + token;\n  } else {\n    delete axios.defaults.headers.common[\"Authorization\"];\n  }\n};\n\nconst refreshToken = () => {\n  if (Cookies.get(\"token\")) {\n    const ref = axios.post(\"http://localhost:8000/api/auth/token/refresh/\", {\n      refresh: Cookies.get(\"token\"),\n    });\n    return ref;\n  } else {\n    store.dispatch({\n      type: SET_CURRENT_USER,\n      payload: null,\n    });\n  }\n};\n\nconst getAccessToken = async () => {\n  await refreshToken()\n    .then((res) => {\n      console.log(res);\n      setToken(res.data.access);\n      const decoded_token = jwt_decode(res.data.access);\n      store.dispatch({\n        type: SET_CURRENT_USER,\n        payload: decoded_token,\n      });\n    })\n    .catch((error) => {\n      store.dispatch({\n        type: GET_ERRORS,\n        payload: error.message,\n      });\n      store.dispatch({\n        type: SET_CURRENT_USER,\n        payload: null,\n      });\n    });\n};\n\nexport { setToken, refreshToken, getAccessToken };\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,UAAU;AAC5B,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,UAAU,EAAEC,gBAAgB,QAAQ,kBAAkB;AAC/D,OAAOC,OAAO,MAAM,WAAW;AAE/B,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EAC1B,IAAIA,KAAK,EAAE;IACTP,KAAK,CAACQ,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGH,KAAK;EACpE,CAAC,MAAM;IACL,OAAOP,KAAK,CAACQ,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC;EACvD;AACF,CAAC;AAED,MAAMC,YAAY,GAAGA,CAAA,KAAM;EACzB,IAAIN,OAAO,CAACO,GAAG,CAAC,OAAO,CAAC,EAAE;IACxB,MAAMC,GAAG,GAAGb,KAAK,CAACc,IAAI,CAAC,+CAA+C,EAAE;MACtEC,OAAO,EAAEV,OAAO,CAACO,GAAG,CAAC,OAAO;IAC9B,CAAC,CAAC;IACF,OAAOC,GAAG;EACZ,CAAC,MAAM;IACLZ,KAAK,CAACe,QAAQ,CAAC;MACbC,IAAI,EAAEb,gBAAgB;MACtBc,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;AACF,CAAC;AAED,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;EACjC,MAAMR,YAAY,CAAC,CAAC,CACjBS,IAAI,CAAEC,GAAG,IAAK;IACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;IAChBf,QAAQ,CAACe,GAAG,CAACG,IAAI,CAACC,MAAM,CAAC;IACzB,MAAMC,aAAa,GAAGxB,UAAU,CAACmB,GAAG,CAACG,IAAI,CAACC,MAAM,CAAC;IACjDxB,KAAK,CAACe,QAAQ,CAAC;MACbC,IAAI,EAAEb,gBAAgB;MACtBc,OAAO,EAAEQ;IACX,CAAC,CAAC;EACJ,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;IAChB3B,KAAK,CAACe,QAAQ,CAAC;MACbC,IAAI,EAAEd,UAAU;MAChBe,OAAO,EAAEU,KAAK,CAACC;IACjB,CAAC,CAAC;IACF5B,KAAK,CAACe,QAAQ,CAAC;MACbC,IAAI,EAAEb,gBAAgB;MACtBc,OAAO,EAAE;IACX,CAAC,CAAC;EACJ,CAAC,CAAC;AACN,CAAC;AAED,SAASZ,QAAQ,EAAEK,YAAY,EAAEQ,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}