{"ast":null,"code":"import axios from \"axios\";\nimport { GET_USERS, GET_USER, GET_ERRORS } from \"./types\";\nimport jwt_decode from \"jwt-decode\";\nexport const getUsers = () => async dispatch => {\n  const res = await axios.get(`http://localhost:8000/api/user/all/`); // console.log(res)\n\n  dispatch({\n    type: GET_USERS,\n    payload: res.data\n  });\n};\nexport const login = LoginRequest => async dispatch => {\n  try {\n    //post => login request\n    const res = await axios.post(\"http://localhost:8000/api/login\", LoginRequest); //extract token from data\n\n    const token = res.data.data.token;\n    console.log(res); //store token in local storage\n\n    localStorage.setItem(\"token\", token); //set token in header\n\n    setToken(token); //get data from response\n\n    const decoded = {\n      name: res.data.data.name,\n      id: res.data.data.id\n    };\n    var decoded2 = jwt_decode(token);\n    /* console.log(decoded2); */\n\n    localStorage.setItem(\"id\", decoded.id);\n    localStorage.setItem(\"scopes\", decoded2.scopes);\n    localStorage.setItem(\"userName\", decoded.name);\n    const res2 = await axios.post(\"http://localhost:8000/api/checkToken\");\n    localStorage.setItem(\"tokenIsValid\", res2.data.message);\n    console.log(res2.data); //dispatch to securityReducer\n\n    dispatch({\n      type: GET_ERRORS,\n      payload: {}\n    });\n    dispatch({\n      type: SET_CURRENT_USER,\n      payload: decoded\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data\n    });\n  }\n};\n/* export const getUser = () => async (dispatch) => {\n  const res = await axios.get(`http://localhost:8000/api/user/`);\n  dispatch({\n    type: GET_USER,\n    payload: res.data,\n  });\n}; */","map":{"version":3,"sources":["/Users/mananlodhia/Desktop/Projects/EventMatcher/frontend/frontend/src/actions/securityActions.js"],"names":["axios","GET_USERS","GET_USER","GET_ERRORS","jwt_decode","getUsers","dispatch","res","get","type","payload","data","login","LoginRequest","post","token","console","log","localStorage","setItem","setToken","decoded","name","id","decoded2","scopes","res2","message","SET_CURRENT_USER","error","response"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,EAAoBC,QAApB,EAA8BC,UAA9B,QAAgD,SAAhD;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,OAAO,MAAMC,QAAQ,GAAG,MAAM,MAAOC,QAAP,IAAoB;AAChD,QAAMC,GAAG,GAAG,MAAMP,KAAK,CAACQ,GAAN,CAAW,qCAAX,CAAlB,CADgD,CAEhD;;AACAF,EAAAA,QAAQ,CAAC;AACPG,IAAAA,IAAI,EAAER,SADC;AAEPS,IAAAA,OAAO,EAAEH,GAAG,CAACI;AAFN,GAAD,CAAR;AAID,CAPM;AASP,OAAO,MAAMC,KAAK,GAAIC,YAAD,IAAkB,MAAOP,QAAP,IAAoB;AACzD,MAAI;AACF;AACA,UAAMC,GAAG,GAAG,MAAMP,KAAK,CAACc,IAAN,CAChB,iCADgB,EAEhBD,YAFgB,CAAlB,CAFE,CAMF;;AACA,UAAME,KAAK,GAAGR,GAAG,CAACI,IAAJ,CAASA,IAAT,CAAcI,KAA5B;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ,EARE,CASF;;AACAW,IAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BJ,KAA9B,EAVE,CAWF;;AACAK,IAAAA,QAAQ,CAACL,KAAD,CAAR,CAZE,CAaF;;AACA,UAAMM,OAAO,GAAG;AACdC,MAAAA,IAAI,EAAEf,GAAG,CAACI,IAAJ,CAASA,IAAT,CAAcW,IADN;AAEdC,MAAAA,EAAE,EAAEhB,GAAG,CAACI,IAAJ,CAASA,IAAT,CAAcY;AAFJ,KAAhB;AAIA,QAAIC,QAAQ,GAAGpB,UAAU,CAACW,KAAD,CAAzB;AACA;;AAEAG,IAAAA,YAAY,CAACC,OAAb,CAAqB,IAArB,EAA2BE,OAAO,CAACE,EAAnC;AACAL,IAAAA,YAAY,CAACC,OAAb,CAAqB,QAArB,EAA+BK,QAAQ,CAACC,MAAxC;AACAP,IAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCE,OAAO,CAACC,IAAzC;AAEA,UAAMI,IAAI,GAAG,MAAM1B,KAAK,CAACc,IAAN,CAAW,sCAAX,CAAnB;AACAI,IAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqCO,IAAI,CAACf,IAAL,CAAUgB,OAA/C;AACAX,IAAAA,OAAO,CAACC,GAAR,CAAYS,IAAI,CAACf,IAAjB,EA3BE,CA6BF;;AACAL,IAAAA,QAAQ,CAAC;AACPG,MAAAA,IAAI,EAAEN,UADC;AAEPO,MAAAA,OAAO,EAAE;AAFF,KAAD,CAAR;AAIAJ,IAAAA,QAAQ,CAAC;AACPG,MAAAA,IAAI,EAAEmB,gBADC;AAEPlB,MAAAA,OAAO,EAAEW;AAFF,KAAD,CAAR;AAID,GAtCD,CAsCE,OAAOQ,KAAP,EAAc;AACdvB,IAAAA,QAAQ,CAAC;AACPG,MAAAA,IAAI,EAAEN,UADC;AAEPO,MAAAA,OAAO,EAAEmB,KAAK,CAACC,QAAN,CAAenB;AAFjB,KAAD,CAAR;AAID;AACF,CA7CM;AA+CP;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import axios from \"axios\";\nimport { GET_USERS, GET_USER, GET_ERRORS } from \"./types\";\nimport jwt_decode from \"jwt-decode\";\n\nexport const getUsers = () => async (dispatch) => {\n  const res = await axios.get(`http://localhost:8000/api/user/all/`);\n  // console.log(res)\n  dispatch({\n    type: GET_USERS,\n    payload: res.data,\n  });\n};\n\nexport const login = (LoginRequest) => async (dispatch) => {\n  try {\n    //post => login request\n    const res = await axios.post(\n      \"http://localhost:8000/api/login\",\n      LoginRequest\n    );\n    //extract token from data\n    const token = res.data.data.token;\n    console.log(res);\n    //store token in local storage\n    localStorage.setItem(\"token\", token);\n    //set token in header\n    setToken(token);\n    //get data from response\n    const decoded = {\n      name: res.data.data.name,\n      id: res.data.data.id,\n    };\n    var decoded2 = jwt_decode(token);\n    /* console.log(decoded2); */\n\n    localStorage.setItem(\"id\", decoded.id);\n    localStorage.setItem(\"scopes\", decoded2.scopes);\n    localStorage.setItem(\"userName\", decoded.name);\n\n    const res2 = await axios.post(\"http://localhost:8000/api/checkToken\");\n    localStorage.setItem(\"tokenIsValid\", res2.data.message);\n    console.log(res2.data);\n\n    //dispatch to securityReducer\n    dispatch({\n      type: GET_ERRORS,\n      payload: {},\n    });\n    dispatch({\n      type: SET_CURRENT_USER,\n      payload: decoded,\n    });\n  } catch (error) {\n    dispatch({\n      type: GET_ERRORS,\n      payload: error.response.data,\n    });\n  }\n};\n\n/* export const getUser = () => async (dispatch) => {\n  const res = await axios.get(`http://localhost:8000/api/user/`);\n  dispatch({\n    type: GET_USER,\n    payload: res.data,\n  });\n}; */\n"]},"metadata":{},"sourceType":"module"}